<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ðŸ’Œ Unspoken Hearts</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@2.6.4/dist/email.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Quicksand&display=swap');
    body {
      font-family: 'Quicksand', sans-serif;
      background: linear-gradient(to right, #ffeef8, #fbefff);
      color: #333;
      padding: 20px;
      max-width: 800px;
      margin: auto;
      animation: fadeInBody 1s ease;
      position: relative;
      overflow-x: hidden;
    }
    body.dark {
      background: linear-gradient(to right, #1e1e1e, #2a2a2a);
      color: #e0e0e0;
    }
    @keyframes fadeInBody { from { opacity: 0; } to { opacity: 1; } }
    @keyframes floatHeart { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-600px); opacity: 0; } }
    h1 {
      text-align: center;
      font-size: 40px;
      font-family: 'Pacifico', cursive;
      color: #ff69b4;
      animation: fadeInBody 1s ease;
      background: linear-gradient(to right, #ff69b4, #ff85c1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .password-screen {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      background-color: #fff0f5;
      position: fixed;
      width: 100%;
      top: 0;
      left: 0;
      z-index: 1000;
      animation: fadeInBody 1s ease;
      transition: opacity 0.5s ease;
    }
    input, button, select, textarea {
      padding: 10px;
      border-radius: 10px;
      margin-top: 10px;
      width: 100%;
      box-sizing: border-box;
    }
    button {
      transition: all 0.3s ease;
    }
    button:hover {
      background-color: #ff69b4;
      color: white;
      cursor: pointer;
      transform: scale(1.05);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }
    .diary-entry {
      background: #fffafc;
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      padding: 15px;
      margin-bottom: 15px;
      animation: fadeInBody 0.5s ease-in-out;
    }
    .diary-entry.red { background-color: #ffe6f0; }
    .diary-entry.blue { background-color: #e6f7ff; }
    body.dark .diary-entry { background: #2c2c2c; color: #ddd; }
    body.dark .diary-entry.red { background-color: #4d2c39; }
    body.dark .diary-entry.blue { background-color: #2c3a4d; }
    .diary-entry small { color: #777; font-size: 0.85em; }
    body.dark .diary-entry small { color: #bbb; }
    .photo-dump {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
    }
    .photo-dump img {
      max-width: 100px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      transition: transform 0.3s ease;
    }
    .photo-dump img:hover {
      transform: scale(1.1);
    }
    .floating-hearts {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 999;
    }
    .heart {
      position: absolute;
      width: 20px;
      height: 20px;
      background: pink;
      border-radius: 50%;
      animation: floatHeart 8s linear infinite;
      opacity: 0.8;
    }
    #calendarContainer {
      margin-top: 30px;
      background: #fffafc;
      padding: 20px;
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
<div class="floating-hearts"></div>
<div class="password-screen">
  <div>
    <h2>Enter Shared Password</h2>
    <input type="password" id="passwordInput" placeholder="Password">
    <button onclick="checkPassword()">Enter</button>
  </div>
</div>

<h1>ðŸ’Œ Unspoken Hearts</h1>
<button onclick="logout()">Log out</button>
<button onclick="toggleDarkMode()">Toggle Dark/Light Mode</button>

<div>
  <select id="entrySender">
    <option value="red">Jeah</option>
    <option value="blue">Dave</option>
  </select>
  <select id="entryCategory">
    <option value="Love Letter">Love Letter</option>
    <option value="Unsaid Thoughts">Unsaid Thoughts</option>
    <option value="Rants">Rants</option>
  </select>
  <select id="fontSelector">
    <option value="Arial, sans-serif">Arial</option>
    <option value="Georgia, serif">Georgia</option>
    <option value="Courier New, monospace">Courier New</option>
    <option value="Times New Roman, serif">Times New Roman</option>
  </select>
  <textarea id="entryText" placeholder="Write something..."></textarea>
  <input type="file" id="entryImage">
  <button onclick="submitEntry()">Submit</button>
</div>

<h2>Filter by Category</h2>
<select id="filterCategory" onchange="loadEntries()">
  <option value="All">All</option>
  <option value="Love Letter">Love Letter</option>
  <option value="Unsaid Thoughts">Unsaid Thoughts</option>
  <option value="Rants">Rants</option>
</select>

<h2>Diary Entries</h2>
<div id="entries"></div>

<h2>Calendar View</h2>
<div id="calendarContainer">
  <input type="text" id="calendar" placeholder="Pick a date to view entries...">
</div>

<h2>Photo Dump</h2>
<div class="photo-dump" id="photoDump"></div>

<script>
  function createFloatingHearts() {
    const container = document.querySelector('.floating-hearts');
    setInterval(() => {
      const heart = document.createElement('div');
      heart.className = 'heart';
      heart.style.left = Math.random() * 100 + '%';
      heart.style.top = '100%';
      heart.style.background = ['#ff99cc', '#ff66b2', '#ffb6c1', '#ffcce6'][Math.floor(Math.random() * 4)];
      container.appendChild(heart);
      setTimeout(() => heart.remove(), 8000);
    }, 800);
  }
  createFloatingHearts();

  flatpickr("#calendar", {
    dateFormat: "Y-m-d",
    onChange: function(selectedDates, dateStr) {
      const selectedDayStart = new Date(dateStr);
      const selectedDayEnd = new Date(selectedDayStart);
      selectedDayEnd.setHours(23, 59, 59, 999);

      const db = firebase.firestore();
      db.collection("entries")
        .orderBy("timestamp", "desc")
        .get()
        .then(snapshot => {
          const container = document.getElementById("entries");
          container.innerHTML = "";

          snapshot.forEach(doc => {
            const data = doc.data();
            const time = new Date(data.timestamp);

            if (time >= selectedDayStart && time <= selectedDayEnd) {
              const div = document.createElement("div");
              div.className = "diary-entry " + data.sender;
              div.style.fontFamily = data.font || 'Arial, sans-serif';
              div.innerHTML = `
                <strong>Category: ${data.category || 'General'}</strong><br>
                <small>${time.toLocaleString()}</small>
                <p>${data.text || ''}</p>
                ${data.image ? `<img src="${data.image}" alt="Attached Image">` : ''}
              `;
              container.appendChild(div);
            }
          });
        });
    }
  });
</script>
</body>
</html>
